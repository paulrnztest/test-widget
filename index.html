<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LivePerson Debug Widget</title>
  <!-- Load the LivePerson Web Agent SDK -->
  <script src="https://lpcdn.lpsnmedia.net/webagent/client-SDK.min.js"></script>
</head>
<body>
  <h1>LivePerson Debug Widget</h1>
  <p>Open your console to see logs.</p>

  <script>
    console.log("Debug Widget Starting...");

    // --- 1️⃣ Initialize Agent SDK ---
    const siteId = "54523770"; // <-- replace with your LivePerson site ID

    lpTag.agentSDK.init({ siteId })
      .then(() => {
        console.log("Agent SDK initialized successfully!");

        // --- 2️⃣ Function to fetch current conversation ID ---
        function printConversationId() {
          const context = lpTag.agentSDK.getContextData?.(); // safe call
          if (context && context.CONVERSATION && context.CONVERSATION.ID) {
            console.log("Active Conversation ID:", context.CONVERSATION.ID);
          } else {
            console.warn("No active conversation yet.");
          }
        }

        // --- 3️⃣ Fetch once immediately ---
        printConversationId();

        // --- 4️⃣ Refresh periodically (every 5 seconds) ---
        setInterval(() => {
          printConversationId();
        }, 5000);

      })
      .catch(err => {
        console.error("Failed to initialize Agent SDK:", err);
      });
  </script>
</body>
</html>

